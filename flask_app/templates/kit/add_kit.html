{% extends "layout.html" %}

{% block content %}
<form action="/add_kit" method="post" onsubmit="return confirmMsg();" onkeypress="return event.keyCode != 13;">
    <div class="container my-container">
        <div class="row">
            <div class="col">
                <h2>Add Kit</h2>
                <hr/>
                <h4>Master Information</h4>
            </div>
        </div>
        <div class="row">
            <div class="col-3 form-group">
                <label for="name">Kit Name:</label>
                <input type="text" class="form-control" id="name" name="name" required>
            </div>
            <div class="col-3 form-group">
                <label for="manu_name">Manufacturer:</label>
                <select class="form-control" id="manu_name" name="manu_name" onchange="enable(this)" required>
                    <option selected="selected"></option>
                    {% for item in manu_name%}
                    <option value="{{item.part_num}},{{item.lot_num}},{{item.exp_date}},{{item.part_start}},{{item.part_end}},{{item.lot_start}},{{item.lot_end}},{{item.exp_date_start}},{{item.exp_date_end}},{{item.comp_barcode}},{{item.comp_part_num}},{{item.comp_lot_num}},{{item.comp_part_start}},{{item.comp_part_end}},{{item.comp_lot_start}},{{item.comp_lot_end}},{{ item.id }}">{{ item.name }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="col-4 form-group">
                <label for="barcode">Box Lot Barcode:</label>
                <input type="text" class="form-control" id="barcode" name="barcode" oninput="update()">
            </div>
        </div>
        <div class="row my-row">
            <div class="col-3 form-group">
                <label for="part_num">Part Number:</label>
                <input type="text" class="form-control" id="part_num" name="part_num">
            </div>
            <div class="col-3 form-group">
                <label for="lot_num">Lot Number:</label>
                <input type="text" class="form-control" id="lot_num" name="lot_num">
            </div>
            <div class="col-3 form-group">
                <label for="exp_date">Expiry Date:</label>
                <input type="date" class="form-control" id="exp_date" name="exp_date" min="{{ today }}" required>
            </div>
            <div class="col-2 form-group">
                <label for="quantity">Quantity:</label>
                <input type="number" value="1" min="1" max="100" step="1" name="quantity" class="form-control" id="quantity"/>
            </div>
        </div>
        <div class="row my-row">
            <div class="col-6 form-group">
                <label for="comment">Comments:</label>
                <textarea class="form-control" name="comment" id="comment" rows="3"></textarea>
            </div>
        </div>
        <hr/>
        <div class="row my-row">
            <div class="col">
                <h4>Component Information</h4>
            </div>
        </div>
        <div id="containers_div">
            <div id="container_div0" style="padding-bottom:30px">
                <div class="row my-row">
                    <div class="col-3 form-group">
                        <label for="comp_name0">Component Name:</label>
                        <input type="text" class="form-control" name="comp_name" id="comp_name0">
                    </div>
                    <div class="col-4 form-group">
                        <label for="comp_barcode0">Component Barcode:</label>
                        <input type="text" class="form-control" name="comp_barcode" id="comp_barcode0" oninput="update_comp(this)">
                    </div>
                    <div class="col-2 form-group"></div>
                    <div class="col-1 form-group">
                        <label style="visibility: hidden;">Traaaaaaaaaaash:</label>
                        <input type="number" value="1" min="1" max="100" step="1" name="copy_num" class="form-control" id="copy_num0"/>
                    </div>
                    <div class="col-2 form-group">
                        <label style="visibility: hidden;">Traaaaaaaaaaash:</label>
                        <button type="button" class="btn btn-default" name="clone" id="clone" onclick="clone_element(this)">
                            <i class="fa fa-clone" style="font-size:24px"></i>
                        </button>
                        <button type="button" class="btn btn-default" name="trash" id="trash" onclick="remove_element(this)">
                            <i class="fa fa-trash-o" style="font-size:24px"></i>
                        </button>
                    </div>
                </div>
                <div class="row my-row">
                    <div class="col-3 form-group">
                        <label for="comp_part_num0">Part Number:</label>
                        <input type="text" class="form-control" name="comp_part_num" id="comp_part_num0">
                    </div>
                    <div class="col-3 form-group">
                        <label for="comp_lot_num0">Lot Number:</label>
                        <input type="text" class="form-control" name="comp_lot_num" id="comp_lot_num0">
                    </div>
                    <div class="col-3 form-group">
                        <label for="comp_exp_date0">Expiry Date:</label>
                        <input type="date" class="form-control" id="comp_exp_date0" name="comp_exp_date" min="{{ today }}">
                    </div>
                    <div class="col-1 form-group">
                        <label for="size0">Size:</label>
                        <select class="form-control" id="size0" name="size">
                            <option value="s" selected="selected">S</option>
                            <option value="m">M</option>
                        </select>
                    </div>
                </div>
                <div class="row my-row">
                    <div class="col-6 form-group">
                        <label for="condition0">Component Condition:</label>
                        <textarea class="form-control" name="condition" id="condition0" rows="1"></textarea>
                    </div>
                </div>
            </div>
        </div>
        <div class="row my-row col-3">
            <button type="button" class="btn btn-outline-info" name="append" id="add_comp" onclick="add_element()">Add Component</button>
        </div>
        <br/>
        <div class="row my-row">
            <div class="col-12">
                <button type="submit" class="btn btn-info button" name="submit" id="submit">Save</button>
                <button type="button" class="btn btn-outline-info button" name="cancel" id="cancel" onclick="window.history.back();">Cancel</button>
            </div>
        </div>
    </div>
    <br/>
</form>
{% endblock content %}

{% block script %}
<script>
	var counter = 1;
	var properties;
	function add_element() {
		var tag = document.createElement("div");
		var today = new Date();
		var today_str = today.getFullYear().toString(10) + "-" + (today.getMonth() + 1).toString(10) + "-"
		if (today.getDate() < 10) {
			today_str += "0" + today.getDate().toString(10);
		} else {
			today_str += today.getDate().toString(10);
		}
		tag.setAttribute("id", "container_div"+counter)
		tag.setAttribute("style", "padding-bottom:30px")
		tag.innerHTML = '<div class="row my-row"><div class="col-3 form-group"> <label for="comp_name'+counter+'">Component Name:</label> <input type="text" class="form-control" name="comp_name" id="comp_name'+counter+'"> </div> <div class="col-4 form-group"> <label for="comp_barcode'+counter+'">Component Barcode:</label> <input type="text" class="form-control" name="comp_barcode" id="comp_barcode'+counter+'" oninput="update_comp(this)"> </div> <div class="col-2 form-group"> </div> <div class="col-1 form-group"> <label style="visibility: hidden;">Traaaaaaaaaaash:</label> <input type="number" value="1" min="1" max="100" step="1" name="copy_num" class="form-control" id="copy_num'+counter+'"/> </div> <div class="col-2 form-group"> <label for="comp_barcode'+counter+'" style="visibility: hidden;">Traaaaaaaaaaash:</label> <button type="button" class="btn btn-default" name="clone" id="clone" onclick="clone_element(this)"> <i class="fa fa-clone" style="font-size:24px"></i> </button> <button type="button" class="btn btn-default" name="trash" id="trash'+counter+'" onclick="remove_element(this)"> <i class="fa fa-trash-o" style="font-size:24px"></i> </button> </div> </div> <div class="row my-row"> <div class="col-3 form-group"> <label for="comp_part_num'+counter+'">Part Number:</label> <input type="text" class="form-control" name="comp_part_num" id="comp_part_num'+counter+'"> </div> <div class="col-3 form-group"> <label for="comp_lot_num'+counter+'">Lot Number:</label> <input type="text" class="form-control" name="comp_lot_num" id="comp_lot_num'+counter+'"> </div> <div class="col-3 form-group"> <label for="comp_exp_date'+counter+'">Expiry Date:</label> <input type="date" class="form-control" name="comp_exp_date" id="comp_exp_date'+counter+'" min="'+ today_str +'"> </div> <div class="col-1 form-group"> <label for="size' + counter + '">Size:</label> <select class="form-control" id="size' + counter + '" name="size"> <option value="s" selected="selected">S</option> <option value="m">M</option> </select> </div> </div> <div class="row my-row"> <div class="col-6 form-group"> <label for="condition'+counter+'">Component Condition:</label><textarea class="form-control" name="condition" id="condition'+counter+'" rows="1"></textarea> </div> </div>';
		document.getElementById("containers_div").appendChild(tag);
		counter++;
	}

</script>
{% endblock script %}